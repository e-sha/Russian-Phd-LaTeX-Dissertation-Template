% !TeX spellcheck = ru_RU

\section*{Общая характеристика работы}

\newcommand{\actuality}{\underline{\textbf{\actualityTXT}}}
\newcommand{\progress}{\underline{\textbf{\progressTXT}}}
\newcommand{\aim}{\underline{{\textbf\aimTXT}}}
\newcommand{\tasks}{\underline{\textbf{\tasksTXT}}}
\newcommand{\novelty}{\underline{\textbf{\noveltyTXT}}}
\newcommand{\influence}{\underline{\textbf{\influenceTXT}}}
\newcommand{\methods}{\underline{\textbf{\methodsTXT}}}
\newcommand{\defpositions}{\underline{\textbf{\defpositionsTXT}}}
\newcommand{\reliability}{\underline{\textbf{\reliabilityTXT}}}
\newcommand{\probation}{\underline{\textbf{\probationTXT}}}
\newcommand{\contribution}{\underline{\textbf{\contributionTXT}}}
\newcommand{\publications}{\underline{\textbf{\publicationsTXT}}}

\input{common/characteristic} % Характеристика работы по структуре во введении и в автореферате не отличается (ГОСТ Р 7.0.11, пункты 5.3.1 и 9.2.1), потому её загружаем из одного и того же внешнего файла, предварительно задав форму выделения некоторым параметрам

%Диссертационная работа была выполнена при поддержке грантов ...

%\underline{\textbf{Объем и структура работы.}} Диссертация состоит из~введения, четырех глав, заключения и~приложения. Полный объем диссертации \textbf{ХХХ}~страниц текста с~\textbf{ХХ}~рисунками и~5~таблицами. Список литературы содержит \textbf{ХХX}~наименование.

%\newpage
\section*{Содержание работы}
Во \underline{\textbf{введении}} обосновывается актуальность исследований, проводимых в рамках данной диссертационной работы, формулируется цель, ставятся задачи работы, сформулированы научная новизна и практическая значимость представляемой работы.

\underline{\textbf{Первая глава}} посвящена обзору научной литературы по изучаемой проблеме.

\iffalse
 картинку можно добавить так:
\begin{figure}[ht] 
  \center
  \includegraphics [scale=0.27] {latex}
  \caption{Подпись к картинке.} 
  \label{img:latex}
\end{figure}

Формулы в строку без номера добавляются так:
\[ 
  \lambda_{T_s} = K_x\frac{d{x}}{d{T_s}}, \qquad
  \lambda_{q_s} = K_x\frac{d{x}}{d{q_s}},
\]

\fi

\underline{\textbf{Вторая глава}} посвящена исследованию задачи обнаружения людей на изображении в сценарии видеонаблюдения. Задача обнаружения объектов интереса на изображения "--- базовая задача компьютерного зрения. Классическим подходом к её решению является метод скользящего окна, основанный на классификации различных регионов изображения на несколько классов (в частном случае на два: <<объект интереса>>, <<другое>>).

В общем случае алгоритмы обнаружения не могут полагаться на априорное знание о положении объектов интереса в сцене и вынуждены просматривать огромное количество возможных положений и масштабов их изображений. Такой подход имеет два негативных последствия: 1) высокая вычислительная сложность анализа и 2) увеличение количества ложных срабатываний.

Сценарий видеонаблюдения имеет особенности, позволяющие получить такую априорную информацию о видеопоследовательности. Во-первых, большинство анализируемых сцен состоят из единственной плоскости земли, где могут находиться объекты интереса (люди или автомобили). Во-вторых, камеры видеонаблюдения являются статичными и параметры их калибровки не меняются со временем. Эти предположения порождают две задачи: 1) определение параметров калибровки камеры по результатам анализа сцены и 2) интеграция параметров калибровки с алгоритмами обнаружения для уточнения результатов обнаружения.

Параметры калибровки камеры разделяют на две части: параметры внешней калибровки, определяющие положение и ориентацию камеры в сцене, и параметры внутренней калибровки, определяющие свойства камеры. Параметры внешней калибровки также называют её позой.

Существующие подходы определения параметров позы камеры и применение её калибровки для уточнения результатов обнаружения накладывают жесткие ограничения на возможные значения позы камеры. Среди таких ограничений представлены отсутствие крена камеры или близость угла наклона к нулю. Причинами таких ограничений являются аналитические модели используемые при построении отображений между размерами и положениями объектов в сцене и параметрами калибровки камеры.

Входными параметрами алгоритма определения позы камеры является видеопоследовательность, снятая статичной камерой, значение её фокусного расстояния и алгоритм локализации людей в сцене. Отличительной особенностью предложенного метода является использование синтетической выборки для построения искомого отображения. Описанные выше предположения о наблюдаемой сцене позволяют построить генеративную математическую модель наблюдаемых данных, состоящую из:
\begin{itemize}
	\item модели сцены в виде плоскости $z=0$;
	\item модели камеры, описываемой фокусным расстоянием $f$;
	\item модели человека \cite{pishchulin15arxiv}.
\end{itemize}
В предложенной модели наблюдаемой сцены поза камеры описывается тремя параметрами: высотой над плоскостью земли $h$, углом наклона $t$ и углом крена $r$. Предложенная модель является генеративной и позволяет синтезировать изображения с помощью средств компьютерной графики. Была построена синтетическая выборка данных видеонаблюдения, состоящая из 100374 различных сцен, каждая из которых характеризуется параметрами калибровки камеры в наблюдаемой сцене. В каждой сцене находилось не менее 200 человек, равномерно распределенных по изображению.

Домены реальных данных видеонаблюдения и синтезированных из модели существенно отличаются из-за отсутствия модели освещения, текстуры и вариативности позы людей. Поэтому в работы было необходимо выбрать признаковое описание инвариантное к такому изменению домена. В качестве признаково описания было предложено использовать результаты обнаружения людей на изображении. Алгоритм обнаружения голов людей на изображении \cite{prisacariu_reid_tr2310_09} был выбран для построения признаково описания. Таким образом, каждый человек в сцене описывается положением центра и размерами ограничивающего прямоугольник его головы.

Для построения отображения признаково описания сцены и фокусного расстояния в значения параметров позы камеры было предложено использовать нейронную сеть. Одному и тому же положению и размерам головы человека в сцене могут соответствовать различные параметры позы камеры. Поэтому регрессия позы камеры осуществляется по прецеденту, объединяющему 64 равномерно распределенных обнаружения человека в сцене. Чтобы порядок описания людей в сцене не влиял на результаты регрессии, люди в прецеденте упорядочены по размеру головы человека.

Синтетическая выборка не содержит результатов ложных срабатываний обнаружения людей в сцене, однако они часто встречаются на практике. Поэтому в обучающие прецеденты были добавлены шумы в виде ограничивающих прямоугольников со случайно выбранными положениями и размерами и дублирующиеся обнаружения объектов.

Таким образом, входными параметрами нейронной сети являлся прецедент $x$, состоящий из 64 положений голов людей в сцене и значений фокусного расстояния камеры. Предсказание нейронной сети интерпретировалось как математическое ожидание $\tilde{l}_c(x, \Theta)$ и параметры матрицы ковариации $\Sigma_c(x, \Theta)$ распределения позы камеры, пораждающей наблюдаемые данные. В работе использовалось предположение, что данное распределение является нормальным:
\begin{equation}
	p(l_{c}|x, \Theta) = N(l_c|\tilde{l_c}(x, \Theta), \Sigma_c(x, \Theta))
\end{equation}
Обучение производилось путем минимизации отрицательного логарифма функции правдоподобия.

Предсказание параметров матрицы ковариации распределения позы камеры позволяет решить несколько задач: 1) уменьшить влияние сложных примеров на процедуру обучения и 2) оценить уверенность регрессора в предсказании на этапе тестирования. Сложными для определения позы камеры являются прецеденты, содержащие большое количество ложных или повторяющихся срабатываний алгоритма обнаружения голов. Значение определителя матрицы ковариации является оценкой степени неуверенности в построенном предсказании.

Тестирование алгоритма проводилось на синтетических данных и на открытых выборках видеонаблюдения. Результаты тестирования показали, что на реальных и синтетических данных, не содержащих ложных срабатываний алгоритма детектирования, поза камеры определятся верно с точностью в 3 отклонения маргинального распределения параметров. Также тестирование показало увеличение значения предсказанной дисперсии маргинальных отклонений параметров позы при увеличении количества шума или уменьшении разнообразия обнаружений в прецеденте.

Рассмотрение задачи построения алгоритма обнаружения людей в сценарии видеонаблюдения, использующего информацию о калибровке камеры, я разбил на две части. Сначала рассматривается метод уточнения результатов базового алгоритма обнаружения для увеличения его точности, после предлагается метод уменьшения вычислительной сложности базового алгоритма обнаружения. В качестве базового можно выбрать произвольный алгоритм обнаружения, основанный на методе скользящего окна. В качестве базового алгоритма я использовал \cite{prisacariu_reid_tr2310_09}, так как он позволяет добиться высокой скорости обработки данных.

Предложенный алгоритм уточнения результатов обнаружения объектов на изображении определяет допустимость каждого обнаружения при заданных параметрах калибровки камеры. Таким образом, он является алгоритмом классификации на два класса: <<правдоподобное>> и <<невозможное>>. Формально входом предложенного алгоритма является ограничивающий прямоугольник обнаруженного объекта $o$ и параметры калибровки камеры в виде фокусного расстояния $f$ и параметров позы камеры $l_c$. Важно отметить, что предыдущие работы решали эту задачу, но при существенных ограничениях на параметры калибровки камеры (отсутствие крена и малое значение наклона) и постоянстве размеров объектов в сцене. Эти ограничения возникали из-за необходимости построения аналитических моделей отображения параметров калибровки камеры в размеры объектов на изображении. Однако, предложенная синтетическая выборка сцен видеонаблюдения, позволила мне обучить необходимый классификатор по данным.

Поскольку синтетическая выборка содержит только верные обнаружения объектов в сцене, то задачу построения классификатора является задачей поиска аномалий в данных. Однако, я свёл её к обучению классификатора путём построения прецедентов отрицательного класса. При этом я объединил две стратегии: 1) использование обнаружений, характерных для других сцен обучающей выборки; 2) использование регионов изображения с произвольным положением и размером. Первая стратегия позволяет обучать классификатор, дискриминативный к калибровке камеры. Вторая позволяет классификатору отличать верные обнаружения от ложных срабатываний базового алгоритма обнаружения объектов $d_p$. При построении отрицательных примеров обучающей выборки эти стратегии использовались в отношении 1:9.

В качестве классификатора использовалась полносвязная нейронная сеть, состоящая из 5 слоёв. Её гиперпараметры (количество слоёв и их размер) обучались по синтетической валидационной выборке. Тестирование алгоритма проводилось на синтетической валидационной выборке и реальных данных видеонаблюдения.  На синтетической выборке тестирование проводилось только на тех сценах, которые не использовались при обучении. Таким образом, удалось показать отсутствие переобучения к параметрам калибровки камеры. Площадь под ROC кривой для валидационной выборки равна 0.926. Полнота обнаружения положительных примеров тестовой выборки составляет 0.971. Тестирование на реальных данных показало, что построенный классификатор позволяет увеличить точность обнаружения объектов без существенного падения полноты.

Предложенный метод уточнения результатов обнаружения объектов был интегрирован с алгоритмом обнаружения объектов в сцене. При известных значениях калибровки камеры построенный классификатор позволяет определить регионы изображения на каждом уровне пирамиды изображений, где изображение голов людей имеют <<правдоподобные>> размеры. Обработка только этих регионов позволяет повысить скорость и точность обработки данных. Из-за особенностей реализации алгоритмов обнаружения производить обработку изображения по произвольной маске оказывается неэффективно. Поэтому в предложенной реализации обработка изображения производится в наименьшем ограничивающем прямоугольнике, содержащем обнаруженную область. Экспериментальная оценка показала, что предложенный алгоритм в среднем классифицирует только 21.19\% всех просматриваемых окон изображения как <<правдоподобные>>. При обработке изображения по прямоугольной маске количество обрабатываемых окон увеличивается до 38.76\%. Существенное увеличение количества обрабатываемых окон характерно для значений позы камер, содержащих существенный крен. Однако такой сценарий редко встречается на практике.

Эксперименты показали, что при использовании предложенного классификатора для сцены выборки TownCentre \cite{benfold2011stable} необходимо обработать только 21.44\% возможных положений головы человека. Обработка прямоугольных регионов изображения увеличивает это значение до 24.03\%. Экспериментальное сравнение показало, что  обработке данных позволяет уменьшить количество анализируемых регионов изображения 

\underline{\textbf{Третья глава}} посвящена исследованию задачи сопровождения людей в видеопоследовательности.

В \underline{\textbf{четвертой главе}} приведено описание предложенной модели позы человека в видео, содержащей модель движения суставов. Также предложены алгоритмы поиска локального оптимума предложенной модели.

В \underline{\textbf{заключении}} приведены основные результаты работы, которые заключаются в следующем:
\input{common/concl}

\iffalse
%\newpage
При использовании пакета \verb!biblatex! список публикаций автора по теме
диссертации формируется в разделе <<\publications>>\ файла
\verb!../common/characteristic.tex!  при помощи команды \verb!\nocite! 
\fi

\ifdefmacro{\microtypesetup}{\microtypesetup{protrusion=false}}{} % не рекомендуется применять пакет микротипографики к автоматически генерируемому списку литературы
\ifnumequal{\value{bibliosel}}{0}{% Встроенная реализация с загрузкой файла через движок bibtex8
  \renewcommand{\refname}{\large \authorbibtitle}
  \nocite{*}
  \insertbiblioauthor                          % Подключаем Bib-базы
  %\insertbiblioother   % !!! bibtex не умеет работать с несколькими библиографиями !!!
}{% Реализация пакетом biblatex через движок biber
  \insertbiblioauthor                          % Подключаем Bib-базы
  %\insertbiblioauthorgrouped
  \insertbiblioother
}
\ifdefmacro{\microtypesetup}{\microtypesetup{protrusion=true}}{}

