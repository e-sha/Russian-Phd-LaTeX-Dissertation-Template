\chapter{Локализация людей на плоскости земли} \label{chapt4}

В этой главе я рассматриваю задачу локализации объектов интереса в наблюдаемой сцене. Этот этап видеонаблюдения позволяет оценить их положение на плане сцены, которая может представлять, например, карту города или торгового центра. В своей работе я рассматриваю сцены, состоящие из единственной плоскости --- плоскости земли, то есть опираюсь на минимальные априорные сведения о наблюдаемой сцене. Если известно положение препятствий (скамейки, урны, стены), то предложенный метод может быть расширен добавлением соответствующих ограничений на положения людей.

Алгоритм определения положения людей в сцене является отображением из входного изображения в координаты человека на плоскости земли. Для формальной постановки этой задачи необходимо дать определение положению человека на плоскости земли. В качестве положения я рассматриваю проекцию на плоскость земли некоторой фиксированной точки тела человека --- его ``центра''. Важно отметить, что положение центра масс не стоит использовать в качестве такой фиксированной точки, поскольку его положение существенно зависит от позы человека. В качестве ``центра'' тела человека я использовал фиксированную точку внутри его туловища.

Информация о положении объектов на изображении помогает при их локализации в сцене. Поэтому я использую метод локализации людей на изображении, описанный в главе \ref{chapt3}, в качестве промежуточного этапа.

\section{Математическая модель наблюдаемых данных}

Я использую модель наблюдаемых данных, описанную в \ref{chap-cam_pose::sec-model}. Используемая модель человека \cite{pishchulin15arxiv} определяет модельную систему координат, центр которой расположен внутри туловища человека. Я использовал центр модельной системы координат модели человека в качестве его ``центра''.

Таким образом, положение человека на плоскости земли я определил как проекцию центра модельной системы координат модели человека на плоскость земли.

\section{Предложенный метод}

Положение человека на изображении существенно ограничивает его возможное положение в сцене. Например, можно рассматривать середину нижней стороны прямоугольника, ограничивающего изображение человека, как проекцию его положения в сцене. Но при этом эта информация может оказаться неполной или недостоверной. Например, при существенном перекрытии или частичном выходе человека за область обзора камеры, ограничивающий прямоугольник человека не позволяет определить его положение в сцене. Поэтому в данной работе я использую метод локализации головы, а не всего тела человека на изображении.

Предложенный метод локализации людей на плоскости земли состоит из двух этапов:
\begin{enumerate}
	\item локализация головы человека на изображении;
	\item определение положения человека в сцене по информции о положении его головы на изображении.
\end{enumerate}
Первый этап описанного подхода детально изложен в главе \ref{chapt3}.

Второй этап алгоритма представляет регрессию положения головы человека на изображении в его координаты на плоскости земли. Перспективные преобразования не позволяют определить положение человека в разных частях сцены с одинаковой точностью. Например, точность локализации людей вблизи горизонта существенно уступает точности их локализации вблизи камеры. Эта особенность приводит к тому, что методы регрессии становятся крайне чувствительны к большим значениям ошибки на таких сложных примерах и переобучаются к ним.

\section{Обучение и экспериментальная оценка}
\subsection{Обучение}
\subsection{Экспериментальная оценка на синтетической выборке}
